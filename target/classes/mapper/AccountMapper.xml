<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.csu.mypetstore.persistence.AccountMapper">

<!--    <select id="getAccountByUsername" parameterType="string" resultType="Account">-->
<!--    SELECT-->
<!--          SUPPLIER.USERNAME,-->
<!--          SUPPLIER.STATUS,-->
<!--          SUPPLIER.ADDR1 AS address1,-->
<!--          SUPPLIER.ADDR2 AS address2,-->
<!--          SUPPLIER.CITY,-->
<!--          SUPPLIER.STATE,-->
<!--          SUPPLIER.ZIP,-->
<!--          SUPPLIERSIGNON.PHONE,-->
<!--    FROM SUPPLIER, SUPPLIERSIGNON-->
<!--    WHERE SUPPLIERSIGNON.USERNAME = #{username}-->
<!--      AND SUPPLIERSIGNON.USERNAME = SUPPLIER.name-->
<!--  </select>-->

    <select id="getAccountByUsername" parameterType="string" resultType="Account">
        SELECT
          *
    FROM SUPPLIERSIGNON
    WHERE SUPPLIERSIGNON.USERNAME = #{username}
  </select>

    <select id="checkPhone" parameterType="string" resultType="Account">
    SELECT
        *
        FROM
        SIGNON
        WHERE
        PHONE = #{phone}
  </select>

    <update id="updateAccount" parameterType="Account">
   UPDATE SUPPLIER SET
      STATUS = #{status},
      ADDR1 = #{address1},
      ADDR2 = #{address2,jdbcType=VARCHAR},
      CITY = #{city},
      STATE = #{state},
      ZIP = #{zip},
      PHONE = #{phone}
    WHERE USERNAME= #{username}
  </update>

    <update id="updatePassword" parameterType="Account">
   UPDATE SUPPLIERSIGNON SET
      PASSWORD = #{password}
    WHERE USERNAME= #{username}
  </update>

    <insert id="insertAccount" parameterType="Account">
    INSERT INTO SUPPLIER
      (name, status,  ADDR1, ADDR2, CITY, STATE, ZIP,  PHONE)
    VALUES
      (#{username}, #{status}, #{address1},  #{address2,jdbcType=VARCHAR}, #{city}, #{state}, #{zip}, #{phone})
  </insert>

    <insert id="insertSignon" parameterType="account">
    INSERT INTO SUPPLIERSIGNON (PASSWORD,USERNAME,PHONENUMBER)
    VALUES (#{password}, #{username},#{phone})
  </insert>

    <update id="updateSignon" parameterType="account">
    UPDATE SUPPLIERSIGNON SET PASSWORD = #{password}
    WHERE USERNAME = #{username}
  </update>






    <select id="getAccountByPhone" parameterType="string" resultType="Account">
    SELECT
          SIGNON.USERNAME,
          ACCOUNT.EMAIL,
          ACCOUNT.FIRSTNAME,
          ACCOUNT.LASTNAME,
          ACCOUNT.STATUS,
          ACCOUNT.ADDR1 AS address1,
          ACCOUNT.ADDR2 AS address2,
          ACCOUNT.CITY,
          ACCOUNT.STATE,
          ACCOUNT.ZIP,
          ACCOUNT.COUNTRY,
          ACCOUNT.PHONE,
          PROFILE.LANGPREF AS languagePreference,
          PROFILE.FAVCATEGORY AS favouriteCategoryId,
          PROFILE.MYLISTOPT AS listOption,
          PROFILE.BANNEROPT AS bannerOption,
          BANNERDATA.BANNERNAME
    FROM ACCOUNT, PROFILE, SIGNON, BANNERDATA
    WHERE ACCOUNT.PHONE = #{phone}
      AND SIGNON.USERNAME = ACCOUNT.USERID
      AND PROFILE.USERID = ACCOUNT.USERID
      AND PROFILE.FAVCATEGORY = BANNERDATA.FAVCATEGORY
  </select>

    <select id="getSignOnByUsernameAndPassword" parameterType="Account" resultType="Account">
        SELECT
        *
        FROM
        SUPPLIERSIGNON
        WHERE
        USERNAME = #{username}
        AND PASSWORD = #{password}
    </select>

    <select id="getSignOnByUsername"  resultType="Account">
        SELECT
        *
        FROM
        SUPPLIERSIGNON
        WHERE
        USERNAME = #{username}
    </select>

    <select id="getSignOnByPhone" parameterType="Account" resultType="Account">
        SELECT
        *
        FROM
        SIGNON
        WHERE
        PHONE = #{phone}
    </select>


    <select id="getAccountByUsernameAndPassword" parameterType="Account" resultType="Account">
    SELECT
      SIGNON.USERNAME AS username,
      ACCOUNT.EMAIL,
      ACCOUNT.FIRSTNAME,
      ACCOUNT.LASTNAME,
      ACCOUNT.STATUS,
      ACCOUNT.ADDR1 AS address1,
      ACCOUNT.ADDR2 AS address2,
      ACCOUNT.CITY,
      ACCOUNT.STATE,
      ACCOUNT.ZIP,
      ACCOUNT.COUNTRY,
      ACCOUNT.PHONE,
      PROFILE.LANGPREF AS languagePreference,
      PROFILE.FAVCATEGORY AS favouriteCategoryId,
      PROFILE.MYLISTOPT AS listOption,
      PROFILE.BANNEROPT AS bannerOption,
      BANNERDATA.BANNERNAME
    FROM ACCOUNT, PROFILE, SIGNON, BANNERDATA
    WHERE ACCOUNT.USERID = #{username}
      AND SIGNON.PASSWORD = #{password}
      AND SIGNON.USERNAME = ACCOUNT.USERID
      AND PROFILE.USERID = ACCOUNT.USERID
      AND PROFILE.FAVCATEGORY = BANNERDATA.FAVCATEGORY
  </select>




</mapper>